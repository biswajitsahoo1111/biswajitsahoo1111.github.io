<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.4.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Biswajit Sahoo" />

  
  
  
    
  
  <meta name="description" content="In this post, we will discuss about Principal Component Analysis (PCA), one of the most popular dimensionality reduction techniques used in machine learning. Applications of PCA and its variants are ubiquitous." />

  
  <link rel="alternate" hreflang="en-us" href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.246129d782c938a644fe2d653d8a976f.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153208457-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-153208457-1', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu9aa3fb3801987e3e09a10d02b6e0c908_114644_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu9aa3fb3801987e3e09a10d02b6e0c908_114644_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="Biswajit Sahoo" />
  <meta property="og:url" content="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" />
  <meta property="og:title" content="Principal Component Analysis - Part I | Biswajit Sahoo" />
  <meta property="og:description" content="In this post, we will discuss about Principal Component Analysis (PCA), one of the most popular dimensionality reduction techniques used in machine learning. Applications of PCA and its variants are ubiquitous." /><meta property="og:image" content="https://biswajitsahoo1111.github.io/media/icon_hu9aa3fb3801987e3e09a10d02b6e0c908_114644_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://biswajitsahoo1111.github.io/media/icon_hu9aa3fb3801987e3e09a10d02b6e0c908_114644_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2019-02-03T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2019-02-03T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/"
  },
  "headline": "Principal Component Analysis - Part I",
  
  "datePublished": "2019-02-03T00:00:00Z",
  "dateModified": "2019-02-03T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Biswajit Sahoo"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Biswajit Sahoo",
    "logo": {
      "@type": "ImageObject",
      "url": "https://biswajitsahoo1111.github.io/media/icon_hu9aa3fb3801987e3e09a10d02b6e0c908_114644_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "In this post, we will discuss about Principal Component Analysis (PCA), one of the most popular dimensionality reduction techniques used in machine learning. Applications of PCA and its variants are ubiquitous."
}
</script>

  

  

  

  





  <title>Principal Component Analysis - Part I | Biswajit Sahoo</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="527b8c4f3fdf046d69095bce30a5e477" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7e85d6cfe81caeb57cc49452f9b55e03.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Biswajit Sahoo</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Biswajit Sahoo</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#blog"><span>Blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/personal"><span>Personal</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Principal Component Analysis - Part I</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Feb 3, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/blog/">Blog</a>, <a href="/category/pca/">PCA</a>, <a href="/category/machine-learning/">Machine Learning</a>, <a href="/category/r/">R</a>, <a href="/category/python/">Python</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>In this post, we will discuss about Principal Component Analysis (PCA),
one of the most popular dimensionality reduction techniques used in
machine learning. Applications of PCA and its variants are ubiquitous.
Thus, a through understanding of PCA is considered essential to start
one&rsquo;s journey into machine learning. In this and subsequent posts, we
will first briefly discuss relevant theory of PCA. Then we will
implement PCA from scratch without using any built-in function. This
will give us an idea as to what happens under the hood when a built-in
function is called in any software environment. Simultaneously, we will
also show how to use built-in commands to obtain results. Finally, we
will reproduce the results of a popular paper on PCA. Including all this
in a single post will make it very very long. Therefore, the post has
been divided into three parts. Readers totally familiar with PCA should
read none and leave this page immediately to save their precious time.
Other readers, who have a passing knowledge of PCA and want to see
different implementations, should pick and choose material from
different parts as per their need. Absolute beginners should start with
Part-I and work their way through gradually. Beginners are also
encouraged to explore the references at the end of this post for further
information. Here is the outline of different parts:</p>
<ul>
<li><a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" target="_blank" rel="noopener">Part-I: Basic Theory of
PCA</a></li>
<li><a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-ii/" target="_blank" rel="noopener">Part-II: PCA Implementation with and without using built-in
functions</a></li>
<li><a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-iii/" target="_blank" rel="noopener">Part-III: Reproducing results of a published paper on
PCA</a></li>
</ul>
<p>For
<a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-ii/" target="_blank" rel="noopener">Part-II</a>,
Python, R, and MATLAB code are available to reproduce all the results.
<a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-iii/" target="_blank" rel="noopener">Part-III</a>
contains both R and Python code to reproduce results of the paper. In
this post, we will discuss the theory behind PCA in brief.</p>
<h1 id="principal-component-analysis">Principal Component Analysis</h1>
<h2 id="theory">Theory:</h2>
<p>Given a data matrix, we apply PCA to transform it in a way such that the
transformed data reveals maximum information. So we have to first get
the data on which we want to perform PCA. The usual convention in
storing data is to place variables as columns and different observations
as rows (Data frames in R follow this convention by default). For
example, let&rsquo;s suppose we are collecting data about daily weather for a
year. Our variables of interest may include maximum temperature in a
day, minimum temperature, humidity, max. wind speed, etc. Everyday we
collect observations for each of these variables. In vector form, our
data point for one day will contain number of observations equal to the
number of variables under study and this becomes one row of our data
matrix. Assuming that we are observing 10 variables everyday, our data
matrix for one year (assuming it&rsquo;s not a leap year) will contain 365
rows and 10 columns. Once data matrix is obtained, further analysis is
done on this data matrix to obtain important hidden information
regarding the data. We will use notations from matrix theory to simplify
our analysis.</p>
<p>Let <code>\(\textbf{X}\)</code> be the data matrix of size <code>\(n\times p\)</code>, where <code>\(n\)</code> is
the number of data points and <code>\(p\)</code> is the number of variables. We can
assume without any loss of generality that data is centered, meaning its
column means are zero. This only shifts the data towards the origin
without changing their relative orientation. So if originally not
centered, it is first centered before doing PCA. From now onward we will
assume that data matrix is always centered.</p>
<p>Variance of a variable (a column) in <code>\(\textbf{X}\)</code> is equal to sum of
squares of entries (because the column is centered) of that column
divided by (n - 1) (to make it unbiased). So sum of variance of all
variables is <code>\(\frac{1}{n - 1}\)</code> times sum of squares of all elements of
the matrix . Readers who are familiar with matrix norms would instantly
recognize that total variance is <code>\(\frac{1}{n - 1}\)</code> times the square of
<strong>Frobenius norm</strong> of <code>\(\textbf{X}\)</code>. Frobenius norm is nothing but square
root of sum of squares of all elements of a matrix.
$$ |\textbf{X}|<em>{F} = (\sum</em>{i,j}{x_{ij}^2})^{\frac{1}{2}}=\sqrt{trace(\textbf{X}^T\textbf{X}})=\sqrt{trace(\textbf{X}\textbf{X}^T})$$</p>
<p>Using this definition, total variance before transformation =
<code>$$\begin{aligned}\frac{1}{n-1}\sum_{i,j}{x_{ij}^2}=\frac{1}{n-1}trace(\textbf{X}^T\textbf{X})  &amp;= trace(\frac{1}{n-1}\textbf{X}^T\textbf{X}) \\  &amp;= \frac{1}{n-1}\|\textbf{X}\|_{F}^2\end{aligned}$$</code></p>
<p>Where, trace of a matrix is the sum of its diagonal entries and
<code>\(\|\textbf{X}\|_{F}^2\)</code> is the square of <strong>Frobenius norm</strong>.</p>
<p>The aim of PCA is to transform the data in such a way that along first
principal direction, variance of transformed data is maximum. It
subsequently finds second principal direction orthogonal to the first
one in such a way that it explains maximum of the remaining variance
among all possible direction in the orthogonal subspace.</p>
<p>In matrix form the transformation can be written as
<code>$$\textbf{Y}_{n\times p}=\textbf{X}_{n\times p}\textbf{P}_{p\times p}$$</code>
Where <code>\(\textbf{Y}\)</code> is the transformed data matrix. The columns of
<code>\(\textbf{Y}\)</code> are called principal components and <code>\(\textbf{P}\)</code> is usually
called loading matrix. Our aim is to find matrix <code>\(\textbf{P}\)</code>. Once we
find <code>\(\textbf{P}\)</code> we can then find <code>\(\textbf{Y}\)</code> just by a matrix
multiplication. We will show in the next section that matrix
<code>\(\textbf{P}\)</code> is the eigenvector matrix of the covariance matrix. Before
that, let&rsquo;s first define the covariance matrix.</p>
<p>Given a data matrix <code>\(\textbf{X}\)</code>(centered), its covariance matrix
<code>\((\textbf{S})\)</code> is defined as
<code>$$\textbf{S} = \frac{1}{n-1}\textbf{X}^T\textbf{X}$$</code>
Now we will show how to compute the loading vectors (columns of <code>\(\textbf{P}\)</code>) and consequently the principal components (columns of <code>\(\textbf{Y}\)</code>) from the given centered data matrix <code>\(\textbf{X}\)</code>.</p>
<h3 id="sketch-of-the-proof">Sketch of the Proof</h3>
<p>We call it a sketch because we will not be giving the full proof.
Rather, we will give the proof only for the first principal component
and then give a commentary as to how it can be extended for other
principal components.</p>
<p>The first principal component is the result obtained by transforming
original data matrix <code>\(\textbf{X}_{n\times p}\)</code> in such a way that
variance of data along first principal component is the highest. The
transformation is a linear transformation that is obtained by taking
linear combination of the columns of <code>\(\textbf{X}_{n\times p}\)</code>. The
coefficients of the linear combination are called loading scores
corresponding to original variables of <code>\(\textbf{X}_{n\times p}\)</code>.</p>
<p>Assuming <code>\(\boldsymbol{\alpha}_{p\times 1} = [\alpha_1, \alpha_2, ..., \alpha_p]^T\)</code>,
where <code>\(\alpha_1\)</code>, <code>\(\alpha_2\)</code>, &hellip; , <code>\(\alpha_p\)</code> are scalars, to be the
loading vector (we don&rsquo;t know, as of now, from where to get
<code>\(\alpha_{p \times 1}\)</code>. We will find that out shortly.), first principal
component is obtained by the the product
<code>\(\textbf{X}_{n\times p}\boldsymbol{\alpha}_{p\times 1}\)</code>. This product can be written
as</p>
<p>$$
\textbf{X}<em>{n\times p}\boldsymbol{\alpha}</em>{p\times 1} = \alpha_1 \textbf{X}<em>{[:,1]} +\alpha_2 \textbf{X}</em>{[:,2]} + &hellip;  + \alpha_p \textbf{X}_{[:,p]}
$$</p>
<p>Where, <code>\(\textbf{X}_{[:,1]}\)</code> is the first column of
<code>\(\textbf{X}_{n\times p}\)</code>. Similarly for other columns. The above
equation makes it clear as to why first principal component is a linear
combination of variables of original data matrix. In the original data
matrix, each column corresponds to a variable.</p>
<p>Variance of first principal component is given by
<code>\(\boldsymbol{\alpha}^T\textbf{X}^T \textbf{X}\boldsymbol{\alpha}\)</code> (As the columns are already
centered. We have also ignored the factor <code>\((\frac{1}{n-1})\)</code> as it is
just a scaling factor.). Now our goal is to find an <code>\(\boldsymbol{\alpha}_{p\times 1}\)</code>
that maximizes <code>\(\boldsymbol{\alpha}^T\textbf{X}^T \textbf{X}\boldsymbol{\alpha}\)</code>. As
<code>\(\boldsymbol{\alpha}_{p\times 1}\)</code> is arbitrary, we can choose its entries in such a
way that variance increases as much as we please. So to get any
meaningful solution, we have to apply some constraints on
<code>\(\boldsymbol{\alpha}_{p\times 1}\)</code>. The conventional condition is
<code>\(\|\boldsymbol{\alpha}_{p\times 1}\|^2 = 1\)</code>. The optimization problem becomes
$$ maximize \ \ \   \boldsymbol{\alpha}^T\textbf{X}^T \textbf{X}\boldsymbol{\alpha}$$
<code>$$s.t. \|\boldsymbol{\alpha}\|^2 = 1$$</code> Using Lagrange multipliers, this problem can
be written as
<code>$$maximize \ \ \  \mathcal{L}(\boldsymbol{\alpha}, \lambda)=\boldsymbol{\alpha}^T\textbf{X}^T \textbf{X}\boldsymbol{\alpha} + \lambda (1 - \boldsymbol{\alpha}^T\boldsymbol{\alpha})$$</code>
Taking gradient of <code>\(\mathcal{L}(\boldsymbol{\alpha}, \lambda)\)</code> with respect to
<code>\(\boldsymbol{\alpha}\)</code> we get, <code>\(\textbf{X}^T\textbf{X}\boldsymbol{\alpha} = \lambda \boldsymbol{\alpha}\)</code>. So
<code>\(\boldsymbol{\alpha}\)</code> is the eigenvector of <code>\(\textbf{X}^T\textbf{X}\)</code>. It turns out
that for first principal component, <code>\(\boldsymbol{\alpha}\)</code> is the eigenvector
corresponding to the largest eigenvalue.</p>
<p>Loading vector for second principal component is computed with the added condition that second loading vector is orthogonal to the first one. With little bit of more work it can be shown that loading vectors for successive principal components are obtained from eigenvectors corresponding to eigenvalues in decreasing order. More details can be found in reference [1].</p>
<p>Now, it is straightforward to first form the covariance matrix and by
placing its eigenvectors as columns, we can find matrix <code>\(\textbf{P}\)</code> and
consequently the principal components. The eigenvectors are arranged in
such a way that first column is the eigenvector corresponding to largest
eigenvector, second column (second eigenvector) corresponds to second
largest eigenvalue and so on. Here we have assumed that we will always
be able to find all the <code>\(p\)</code> orthogonal eigenvectors. In fact, we will
always be able to find <code>\(p\)</code> orthogonal eigenvectors as the matrix is
symmetric. It can also be shown that the transformed matrix <code>\(\textbf{Y}\)</code>
is centered and more remarkably, total variance of columns of
<code>\(\textbf{Y}\)</code> is same as total variance of columns of <code>\(\textbf{X}\)</code>. We
will prove these two propositions as the proofs are short.</p>
<h3 id="properties-of-pca-transformation">Properties of PCA Transformation</h3>
<ol>
<li>
<p>Principal components are centered.</p>
<p><strong>Proof</strong>: Let <code>\(\textbf{1}\)</code> be a column vector of all ones of size
<code>\((n\times 1)\)</code>. To prove that columns of <code>\(\textbf{Y}\)</code> are centered,
just premultiply it by <code>\(\textbf{1}^T\)</code> (this finds column sum for
each column). So
<code>$$\textbf{1}^T \textbf{Y} = \textbf{1}^T\textbf{X}\textbf{P}$$</code> But
columns of <code>\(\textbf{X}\)</code> are already centered, so
<code>\(\textbf{1}^T\textbf{X}=\textbf{0}\)</code>. Thus
<code>\(\textbf{1}^T \textbf{Y}= \textbf{0}\)</code>. Hence columns of <code>\(\textbf{Y}\)</code>
are centered.</p>
</li>
<li>
<p>Sum of variance of principal components is equal to sum of variance
of variables before transformation.</p>
<p><strong>Proof</strong>: To prove that total variance of <code>\(\textbf{Y}\)</code> also remains
same, observe that</p>
<p>$$\begin{aligned} \mbox{total covariance of} \ \  \textbf{Y} &amp;=
trace(\frac{1}{n-1}\textbf{Y}^{T}\textbf{Y}) \ &amp;=\frac{1}{n-1}trace((\textbf{P}^T\textbf{X}^{T}\textbf{X})\textbf{P}) \ &amp;=\frac{1}{n-1}trace((\textbf{P}\textbf{P}^T)\textbf{X}^{T}\textbf{X}) \
&amp;= trace(\frac{1}{n-1}\textbf{X}^T\textbf{X})\end{aligned}$$<code> The previous equation uses the fact that trace is commutative(i.e.$trace(\textbf{AB})=trace(\textbf{BA})$) and </code>(\textbf{P})<code>is orthogonal (i.e.</code>(\textbf{P}\textbf{P}^T=\textbf{I})`).</p>
</li>
<li>
<p>Principal components are orthogonal.</p>
<p><strong>Proof</strong>: To prove the above claim, it is sufficient to show that
the matrix <code>\(\textbf{Y}^T\textbf{Y}\)</code> is diagonal. Remember that columns of <code>\(\textbf{Y}\)</code> are principal components. So if we can somehow show <code>\(\textbf{Y}^T\textbf{Y}\)</code> to be diagonal, it would automatically mean that principal components are orthogonal.
We know, <code>\(\textbf{Y} = \textbf{X}\textbf{P}\)</code>. So <code>\(\textbf{Y}^T\textbf{Y} = \textbf{P}^T\textbf{X}^T\textbf{X}\textbf{P}\)</code>. From sketch of the proof, we know that <code>\(\textbf{P}\)</code> is orthogonal as we have required successive loading vectors to be orthogonal to previous ones. We also know that <code>\(\textbf{P}\)</code> is the eigenvector matrix of <code>\(\textbf{X}^T\textbf{X}\)</code>. So from <a href="https://mathworld.wolfram.com/EigenDecompositionTheorem.html" target="_blank" rel="noopener">Eigen Decomposition Theorem</a>, it follows that <code>\(\textbf{P}^T(\textbf{X}^T\textbf{X})\textbf{P}\)</code> is diagonal as <code>\(\textbf{P}\)</code> is the eigenvector matrix of <code>\(\textbf{X}^T\textbf{X}\)</code> and <code>\(\textbf{P}\)</code> is orthogonal (so <code>\(\textbf{P}^{-1} = \textbf{P}^T\)</code>).</p>
</li>
</ol>
<h3 id="link-between-total-variance-and-eigenvalues">Link between total variance and eigenvalues</h3>
<p>Total variance is sum of eigenvalues of covariance matrix
<code>\((\textbf{S})\)</code>. This follows from the fact that <span style="color: hotpink"><em>trace of a matrix is sum of its eigenvalues</em></span>. Total variance of original data matrix is <code>\(\frac{1}{n-1}trace(\textbf{X}^T\textbf{X}) =trace(\frac{1}{n-1}\textbf{X}^T\textbf{X}) = trace(\textbf{S})\)</code>. We will show these calculations using a publicly available dataset in
<a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-ii/" target="_blank" rel="noopener">Part-II</a>.</p>
<h3 id="variations-of-pca">Variations of PCA</h3>
<p>Sometimes our data matrix contains variables that are measured in
different units. So we might have to scale the centered matrix to reduce
the effect of variables with large variation. So depending on the matrix
on which PCA is performed, it is divided into two types.</p>
<ul>
<li>Covariance PCA (Data matrix is centered but <strong>not</strong> scaled)</li>
<li>Correlation PCA (Data matrix is centered and scaled)</li>
</ul>
<p>Examples of these two types can be found in
<a href="https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-ii/" target="_blank" rel="noopener">Part-II</a>.
Please note that the above two variations are just two among many
variations. There are <strong>Sparse PCA</strong>, <strong>Kernel PCA</strong>, <strong>Robust PCA</strong>,
<strong>Non-negative PCA</strong> and many others. We have mentioned the two that are
most widely used.</p>
<h3 id="some-common-terminologies-associated-with-pca">Some common terminologies associated with PCA</h3>
<p>In literature, there is no standard terminology for different terms in
PCA. Different people use different (often contradictory) terminology
thus confusing newcomers. Therefore, it is better to stick to one set of
terminologies and notations and use those consistently. We will stick to
the terminology used in reference [2].</p>
<ul>
<li>
<p><strong>Factor scores</strong> corresponding to a principal component: Values of
that column of <code>\(\textbf{Y}\)</code> that corresponds to the desired
principal component.</p>
</li>
<li>
<p><strong>Loading score</strong>: Values corresponding to a column of <code>\(\textbf{P}\)</code>.
For example,loading scores of variables corresponding to first
principal component are the values of the first column of
<code>\(\textbf{P}\)</code>.</p>
</li>
<li>
<p><strong>Inertia</strong>: Square of Frobenius norm of the matrix.</p>
</li>
</ul>
<h3 id="how-actually-are-principal-components-computed">How actually are principal components computed?</h3>
<p>The previously stated method of finding eigenvectors of covariance
matrix is not computationally efficient. In practice, singular value
decomposition (SVD) is used to compute the matrix <code>\(\textbf{P}\)</code>. SVD
theorem tells that any real matrix <code>\(\textbf{X}\)</code> can be decomposed into
three matrices such that $$ \textbf{X} = \textbf{U}\Sigma\textbf{V}^T$$
Where, <code>\(\textbf{X}\)</code> is of size <code>\(n\times p\)</code>. <code>\(\textbf{U}\)</code> and
<code>\(\textbf{V}\)</code> are orthogonal matrices of size <code>\(n\times n\)</code> and <code>\(p\times p\)</code>
respectively. <code>\(\Sigma\)</code> is a diagonal matrix of size <code>\(n\times p\)</code>.</p>
<p>Given the SVD decomposition of a matrix <code>\(\textbf{X}\)</code>,
<code>$$\textbf{X}^T\textbf{X}=\textbf{V}\Sigma^2\textbf{V}^T$$</code></p>
<p>This is the eigen-decomposition of <code>\(\textbf{X}^T\textbf{X}\)</code>. So
<code>\(\textbf{V}\)</code> is the eigenvector matrix of <code>\(\textbf{X}^T\textbf{X}\)</code>. For
PCA we need eigenvector matrix of covariance matrix. So converting the
equation into convenient form, we get
<code>$$\textbf{S} = \frac{1}{n-1}\textbf{X}^T\textbf{X}=\textbf{V}(\frac{1}{n-1}\Sigma^2)\textbf{V}^T$$</code>
Thus eigenvalues of S are diagonal entries of <code>\((\frac{1}{n-1}\Sigma^2)\)</code>.
As SVD is computationally efficient, all built-in functions use SVD to
compute the loading matrix and then use the loading matrix to find
principal components.</p>
<p>In the interest of keeping the post at a reasonable length, we will stop
our exposition of theory here. Whatever we have discussed is only a
fraction of everything. Entire books have been written on PCA.
Interested readers who want to pursue this further can refer the
references of this post as a starting point. Readers are encouraged to
bring any errors or omissions to my notice.</p>
<p>Last modified: May 5, 2021</p>
<h2 id="references">References</h2>
<ol>
<li>I.T. Jolliffe, Principal component analysis, 2nd ed, Springer, New
York,2002.</li>
<li>Abdi, H., &amp; Williams, L. J. (2010). Principal component analysis.
Wiley interdisciplinary reviews: computational statistics, 2(4),
433-459.</li>
</ol>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/pca/">PCA</a>
  
  <a class="badge badge-light" href="/tag/machine-learning/">Machine Learning</a>
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/&amp;text=Principal%20Component%20Analysis%20-%20Part%20I" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/&amp;t=Principal%20Component%20Analysis%20-%20Part%20I" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Principal%20Component%20Analysis%20-%20Part%20I&amp;body=https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/&amp;title=Principal%20Component%20Analysis%20-%20Part%20I" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Principal%20Component%20Analysis%20-%20Part%20I%20https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://biswajitsahoo1111.github.io/post/principal-component-analysis-part-i/&amp;title=Principal%20Component%20Analysis%20-%20Part%20I" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu476bd1525903b1675f874d29f09d9583_189374_270x270_fill_q75_lanczos_center.jpg" alt="Biswajit Sahoo">
    

    <div class="media-body">
      <h5 class="card-title">Biswajit Sahoo</h5>
      <h6 class="card-subtitle">ML Engineer</h6>
      <p class="card-text">My research interests include machine learning, deep learning, signal processing and data-driven machinery condition monitoring.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/biswajitsahoo1111" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/biswajitsahoo1111/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.in/citations?hl=en&amp;user=zu2CSBMAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://medium.com/@biswajitsahoo1111" target="_blank" rel="noopener">
        <i class="fab fa-medium"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/principal-component-analysis-part-iii/">Principal Component Analysis - Part III</a></li>
      
      <li><a href="/post/principal-component-analysis-part-ii/">Principal Component Analysis - Part II</a></li>
      
      <li><a href="/publication/spca_fault_diagnosis/">Feature Subset Selection Using Sparse Principal Component Analysis and Multiclass Fault Classification Using Selected Features</a></li>
      
      <li><a href="/post/reading-multiple-files-in-tensorflow-2-using-sequence/">Reading multiple files in Tensorflow 2 using Sequence</a></li>
      
      <li><a href="/post/reading-multiple-csv-files-in-pytorch/">Reading multiple csv files in PyTorch</a></li>
      
    </ul>
  </div>
  




    </div>
    <div class="col-12 col-lg-10ish article-style">
    <script src="https://utteranc.es/client.js"
        repo="biswajitsahoo1111/biswajitsahoo1111.github.io"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
    </div>


  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  
  
  <p class="powered-by">
    © 2022 Biswajit Sahoo &middot; 

    Powered by <a href="https://www.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package and the
    <a href="https://github.com/wowchemy/starter-hugo-academic" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.9592335d574f7a97010f99b90ad0f310.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r, python, latex, bash.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.e14897cafececa7181d21d62540ef117.js"></script>

    






</body>
</html>
