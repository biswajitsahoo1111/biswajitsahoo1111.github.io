<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: March 17, 2024 --><html lang="en-us" >


<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



























  
  
  






  <meta name="author" content="Biswajit Sahoo" />





  

<meta name="description" content="View source on GitHubIn this notebook, we will try to compute the stiffness matrix of a rectangular element using symbolic computations in Julia. Traditionally in undergraduate curriculum, computations of stiffness matrix for different elements are taught using hand calculations." />



<link rel="alternate" hreflang="en-us" href="http://localhost:1313/post/compute-element-stiffness-matrix-symbolically/" />
<link rel="canonical" href="http://localhost:1313/post/compute-element-stiffness-matrix-symbolically/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hubfdc04a733bd2d8af21820718fcf71ca_131045_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hubfdc04a733bd2d8af21820718fcf71ca_131045_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />
<meta property="twitter:image" content="http://localhost:1313/media/icon_hubfdc04a733bd2d8af21820718fcf71ca_131045_512x512_fill_lanczos_center_3.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="Biswajit Sahoo" />
<meta property="og:url" content="http://localhost:1313/post/compute-element-stiffness-matrix-symbolically/" />
<meta property="og:title" content="Compute element stiffness matrix symbolically | Biswajit Sahoo" />
<meta property="og:description" content="View source on GitHubIn this notebook, we will try to compute the stiffness matrix of a rectangular element using symbolic computations in Julia. Traditionally in undergraduate curriculum, computations of stiffness matrix for different elements are taught using hand calculations." /><meta property="og:image" content="http://localhost:1313/media/icon_hubfdc04a733bd2d8af21820718fcf71ca_131045_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2024-02-23T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2024-02-23T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/compute-element-stiffness-matrix-symbolically/"
  },
  "headline": "Compute element stiffness matrix symbolically",
  
  "datePublished": "2024-02-23T00:00:00Z",
  "dateModified": "2024-02-23T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Biswajit Sahoo"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Biswajit Sahoo",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/media/icon_hubfdc04a733bd2d8af21820718fcf71ca_131045_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "View source on GitHub\rIn this notebook, we will try to compute the stiffness matrix of a rectangular element using symbolic computations in Julia. Traditionally in undergraduate curriculum, computations of stiffness matrix for different elements are taught using hand calculations."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Compute element stiffness matrix symbolically | Biswajit Sahoo</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="42d1b6ff5224ee1cb5ff4b0f11bf5091" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Biswajit Sahoo</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Biswajit Sahoo</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#blog"><span>Blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/personal"><span>Personal</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  













  

  
  
  
<div class="article-container pt-3">
  <h1>Compute element stiffness matrix symbolically</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Feb 23, 2024
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    34 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/blog/">Blog</a>, <a href="/category/julia/">Julia</a>, <a href="/category/fea/">FEA</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <table class="tfo-notebook-buttons" align="left">
  <td>
    <a href="https://github.com/biswajitsahoo1111/blog_notebooks/blob/master/compute_element_stiffness_matrix_symbolically/compute_element_stiffness_matrix_symbolically.ipynb" target="_blank">
    <img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png" />
    View source on GitHub</a>
  </td>
</table>
<style>
.wide-matrix-container {
    overflow-x: auto;
}
</style>
<p>In this notebook, we will try to compute the stiffness matrix of a rectangular element using symbolic computations in Julia. Traditionally in undergraduate curriculum, computations of stiffness matrix for different elements are taught using hand calculations. However, using symbolic calculations along with matrix notation it is straight forward to derive those matrices. Though MATLAB is still widely used in engineering courses and also contains symbolic computation module, we will use Julia as it is open source and Julia&rsquo;s matrix notations are nearly identical to that of MATLAB&rsquo;s. Steps to run this notebook in VS Code along with different required installations can be found <a href="https://code.visualstudio.com/docs/languages/julia" target="_blank" rel="noopener">here</a>.</p>
<p>Below, we will go over the steps followed to derive the element stiffness matrix. We will briefly go over the theory and use only the required equations. For a detailed exploration, readers are directed to the books mentioned in the references. Our example is focused on rectangular element only. However, the same approach can be followed for other elements with minor modifications.</p>
<p>Steps to derive element stiffness matrix:</p>
<ol>
<li>Select the element type</li>
<li>Select displacement function</li>
<li>Define the strain-displacement and stress-strain relationships</li>
<li>Derive the element stiffness matrix</li>
</ol>
<p>All the steps are briefly elaborated below along with the code to implement it. The notebook can be run from beginning to end sequentially to get the required results.</p>
<p><strong>Note</strong>: This blog contains several equations. If equations are not rendered properly in this page, readers are requested to download the jupyter notebook (from above) and use it. All the content of this blog is also available in the jupyter notebook.</p>
<h2 id="1-select-the-element-type">1. Select the element type</h2>
<h3 id="bilinear-rectangle-q4-element">Bilinear Rectangle (Q4) Element</h3>
<p>















<figure  id="figure-bilinear-rectangle-q4">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="./rectangular_element_fea.png" alt="Image of Bilinear Rectangle (Q4) element" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      Bilinear Rectangle (Q4)
    </figcaption></figure>
</p>
<p>If the above figure is not clearly visible, consider changing the theme of background to &ldquo;light&rdquo;. Then the figure would be seen clearly. The element has 4 nodes and 8 degrees of freedom. It&rsquo;s also called Q4 because it is a quadrilateral having 4 nodes. Standard counter-clockwise convention is used to name the nodes.</p>
<p>First load the relevant libraries. If a library is not installed, follow the instructions given in <a href="https://docs.julialang.org/en/v1/stdlib/Pkg/" target="_blank" rel="noopener">this link</a> to download those.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">Symbolics</span><span class="p">,</span> <span class="n">SymbolicNumericIntegration</span>
</span></span><span class="line"><span class="cl"><span class="nb">ENV</span><span class="p">[</span><span class="s">&#34;COLUMNS&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">240</span><span class="p">;</span>  <span class="c"># For better display of symbolic columns</span>
</span></span></code></pre></div><p>The variables to be used in the symbolic computation are defined below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="nd">@variables</span> <span class="n">x</span> <span class="n">y</span> <span class="n">a</span> <span class="n">b</span> <span class="n">ν</span><span class="p">;</span>   <span class="c"># Last symbol &#34;nu&#34; can be obtained in Julia by &#34;\nu&#34; command.</span>
</span></span></code></pre></div><h2 id="2-select-the-displacement-function">2. Select the displacement function</h2>
<p>In FEA, usually we are interested in the values of certain field quantities (for e.g., displacement) at the nodes and between the nodes. Therefore, interpolation is used to devise a continuous function that satisfies prescribed conditions (for e.g., for a compatible displacement field, element displacement must be linear along the edge between two nodes) at the nodes. For the rectangular element, following displacement function is used


$$u = a_1 + a_2x + a_3y + a_4 xy$$


$$v = a_5 + a_6x + a_7y + a_8 xy$$
Where, $a_1, a_2, \ldots, a_8$ are called generalized degrees of freedom. In matrix form, it can be written as



$$\begin{bmatrix}
u \\
v 
\end{bmatrix} = 
\begin{bmatrix}
1 & x & y & xy & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & x & y & xy
\end{bmatrix}
\begin{bmatrix}
a_1 \\
a_2 \\
a_3 \\
a_4 \\
a_5 \\
a_6 \\
a_7 \\
a_8
\end{bmatrix} = [X]_{2 \times 8} [a]_{8 \times 1}$$
</p>
<p>In terms of nodal displacements, the displacement functions can be written as</p>
<div class="wide-matrix-container">
\begin{equation}
\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\phi_5 \\
\phi_6 \\
\phi_7 \\
\phi_8 
\end{bmatrix} = 
\begin{bmatrix}
1 & -a & -b & ab & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & -a & -b & ab \\
1 & a & -a & -ab & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & a & -b & -ab \\
1 & a & b & ab & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & a & b & ab \\
1 & -a & b & -ab & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & -a & b & -ab \\
\end{bmatrix}
\begin{bmatrix}
a_1 \\
a_2 \\
a_3 \\
a_4 \\
a_5 \\
a_6 \\
a_7 \\
a_8
\end{bmatrix} = [A]_{8 \times 8} [a]_{8 \times 1}
\end{equation}
</div>
<p>Where displacements $\phi_1$, $\phi_2$, etc. are displacements at node 1, 2, etc. respectively. By substituting generalized coordinates obtained from nodal equations in displacement function, we get shape functions (or basis functions).</p>



$$\begin{bmatrix}
u \\
v 
\end{bmatrix} = [X]_{2 \times 8} 
\begin{bmatrix}
a_1 \\
a_2 \\
a_3 \\
a_4 \\
a_5 \\
a_6 \\
a_7 \\
a_8
\end{bmatrix} = [X]_{2 \times 8} [A^{-1}]_{8 \times 8}
\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\phi_5 \\
\phi_6 \\
\phi_7 \\
\phi_8 
\end{bmatrix} = [N]_{2 \times 8}
\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\phi_5 \\
\phi_6 \\
\phi_7 \\
\phi_8 
\end{bmatrix}
$$

<p>By running following code cells, we can obtain the expression for shape function matrix.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="n">x</span> <span class="n">y</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="n">x</span> <span class="n">y</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">]</span>
</span></span></code></pre></div>


$$ \begin{equation}
\left[
\begin{array}{cccccccc}
1 & x & y & x y & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & x & y & x y \\
\end{array}
\right]
\end{equation}
 $$
 
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">b</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">b</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span> <span class="n">a</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="n">a</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span> <span class="n">a</span> <span class="n">b</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="n">a</span> <span class="n">b</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="n">b</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="n">b</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">]</span>
</span></span></code></pre></div>


$$ \begin{equation}
\left[
\begin{array}{cccccccc}
1 &  - a &  - b & a b & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 &  - a &  - b & a b \\
1 & a &  - b &  - a b & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & a &  - b &  - a b \\
1 & a & b & a b & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & a & b & a b \\
1 &  - a & b &  - a b & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 &  - a & b &  - a b \\
\end{array}
\right]
\end{equation}
 $$
 
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span></span></code></pre></div><div class="wide-matrix-container">
\begin{equation}
\left[
\begin{array}{cccccccc}
\frac{1}{4} + \frac{ - y}{4 b} + \frac{x y}{4 a b} + \frac{ - x}{4 a} & 0 & \frac{1}{4} + \frac{ - x y}{4 a b} + \frac{ - y}{4 b} + \frac{x}{4 a} & 0 & \frac{1}{4} + \frac{y}{4 b} + \frac{x y}{4 a b} + \frac{x}{4 a} & 0 & \frac{1}{4} + \frac{ - x y}{4 a b} + \frac{y}{4 b} + \frac{ - x}{4 a} & 0 \\
0 & \frac{1}{4} + \frac{ - y}{4 b} + \frac{x y}{4 a b} + \frac{ - x}{4 a} & 0 & \frac{1}{4} + \frac{ - x y}{4 a b} + \frac{ - y}{4 b} + \frac{x}{4 a} & 0 & \frac{1}{4} + \frac{y}{4 b} + \frac{x y}{4 a b} + \frac{x}{4 a} & 0 & \frac{1}{4} + \frac{ - x y}{4 a b} + \frac{y}{4 b} + \frac{ - x}{4 a} \\
\end{array}
\right]
\end{equation}
</div>
<h3 id="3-define-strain-displacement-and-stress-strain-relationship">3. Define strain-displacement and stress-strain relationship</h3>
<p>Using the definition of axial and shear strain, the strain-displacement equation (in matrix form) can be written as follows:



$$\begin{bmatrix}
\epsilon_x \\
\epsilon_y \\
\gamma_{xy}
\end{bmatrix} = 
\begin{bmatrix}
\frac{\partial}{\partial x} & 0 \\
0 & \frac{\partial}{\partial y} \\
\frac{\partial}{\partial y} & \frac{\partial}{\partial x}
\end{bmatrix}
\begin{bmatrix}
u \\
v
\end{bmatrix}
$$

In terms of nodal coordinates, the above equation can also be written as:



$$
\begin{bmatrix}
\epsilon_x \\
\epsilon_y \\
\gamma_{xy}
\end{bmatrix} = 
\begin{bmatrix}
\frac{\partial}{\partial x} & 0 \\
0 & \frac{\partial}{\partial y} \\
\frac{\partial}{\partial y} & \frac{\partial}{\partial x}
\end{bmatrix}
[N]_{2 \times 8}
\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\phi_5 \\
\phi_6 \\
\phi_7 \\
\phi_8 
\end{bmatrix} = 
[B]_{3 \times 8}
\begin{bmatrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\phi_5 \\
\phi_6 \\
\phi_7 \\
\phi_8 
\end{bmatrix}
$$

We need the [B] matrix as that would be used in the computation of stiffness matrix. In the cell below we define the differential operators with respect to x and y.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">D_x</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D_y</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>(::Differential) (generic function with 3 methods)
</code></pre>
<p>Then we apply the operator to the first row of [N] matrix.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="p">[</span><span class="n">expand_derivatives</span><span class="p">(</span><span class="n">D_x</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">]]</span>
</span></span></code></pre></div>


$$ \begin{equation}
\left[
\begin{array}{c}
\frac{-1}{4 a} + \frac{y}{4 a b} \\
0 \\
\frac{1}{4 a} + \frac{ - y}{4 a b} \\
0 \\
\frac{y}{4 a b} + \frac{1}{4 a} \\
0 \\
\frac{-1}{4 a} + \frac{ - y}{4 a b} \\
0 \\
\end{array}
\right]
\end{equation}
 $$

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="n">vcat</span><span class="p">([</span><span class="n">expand_derivatives</span><span class="p">(</span><span class="n">D_x</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">]]</span><span class="o">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="n">expand_derivatives</span><span class="p">(</span><span class="n">D_y</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">]]</span><span class="o">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">expand_derivatives</span><span class="p">(</span><span class="n">D_y</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">]]</span><span class="o">&#39;</span> <span class="o">+</span> <span class="p">[</span><span class="n">expand_derivatives</span><span class="p">(</span><span class="n">D_x</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">]]</span><span class="o">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="wide-matrix-container">
\begin{equation}
\left[
\begin{array}{cccccccc}
\frac{-1}{4 a} + \frac{y}{4 a b} & 0 & \frac{1}{4 a} + \frac{ - y}{4 a b} & 0 & \frac{y}{4 a b} + \frac{1}{4 a} & 0 & \frac{-1}{4 a} + \frac{ - y}{4 a b} & 0 \\
0 & \frac{x}{4 a b} + \frac{-1}{4 b} & 0 & \frac{ - x}{4 a b} + \frac{-1}{4 b} & 0 & \frac{x}{4 a b} + \frac{1}{4 b} & 0 & \frac{ - x}{4 a b} + \frac{1}{4 b} \\
\frac{x}{4 a b} + \frac{-1}{4 b} & \frac{-1}{4 a} + \frac{y}{4 a b} & \frac{ - x}{4 a b} + \frac{-1}{4 b} & \frac{1}{4 a} + \frac{ - y}{4 a b} & \frac{x}{4 a b} + \frac{1}{4 b} & \frac{y}{4 a b} + \frac{1}{4 a} & \frac{ - x}{4 a b} + \frac{1}{4 b} & \frac{-1}{4 a} + \frac{ - y}{4 a b} \\
\end{array}
\right]
\end{equation}
</div>
<h2 id="4-derive-the-element-stiffness-matrix">4. Derive the element stiffness matrix</h2>
<p>Without derivation, we define the stiffness matrix as:



$$[k]_{8 \times 8} = \int_{-b}^b \int_{-a}^{a}[B]^T_{8 \times 3}[E]_{3 \times 3} [B]_{3 \times 8} t dx dy$$
</p>
<p>Where $t$ is the element thickness. Matrix $[E]$ is called the constitutive matrix (it is also named as [D] in some literature).For a derivation, readers are directed to the the excellent books in the references. In the following cell, we define $[E] * (1 - \nu^2)$. We do so to remove $(1 - \nu^2)$ term from all the entries of stiffness matrix.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="c"># Consider the [E] (constitutive matrix) below as product of E (elastic modulus) and (1 - ν^2)</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="n">ν</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ν</span> <span class="mi">1</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="mi">0</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ν</span><span class="p">)</span><span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
</span></span></code></pre></div>


$$ \begin{equation}
\left[
\begin{array}{ccc}
1 & \nu & 0 \\
\nu & 1 & 0 \\
0 & 0 & \frac{1}{2} \left( 1 - \nu \right) \\
\end{array}
\right]
\end{equation}
 $$
 
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">K</span> <span class="o">=</span> <span class="n">B</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">B</span>
</span></span></code></pre></div><div class="wide-matrix-container">
\begin{equation}
\left[
\begin{array}{cccccccc}
\left( \frac{-1}{4 a} + \frac{y}{4 a b} \right)^{2} + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right)^{2} \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) \\
\left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right)^{2} + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right)^{2} \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) + \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu & \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) \\
\left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu & \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right)^{2} + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right)^{2} \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) + \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu \\
\left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right)^{2} + \frac{1}{2} \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right)^{2} \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \nu + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) \\
\left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) + \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu & \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \nu + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{y}{4 a b} + \frac{1}{4 a} \right)^{2} + \frac{1}{2} \left( \frac{x}{4 a b} + \frac{1}{4 b} \right)^{2} \left( 1 - \nu \right) & \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) \\
\left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) + \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{x}{4 a b} + \frac{1}{4 b} \right)^{2} + \frac{1}{2} \left( \frac{y}{4 a b} + \frac{1}{4 a} \right)^{2} \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) + \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) \\
\left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \nu & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) + \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \nu & \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right)^{2} + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right)^{2} \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) \\
\left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{-1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{-1}{4 a} + \frac{y}{4 a b} \right) \left( 1 - \nu \right) & \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) + \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \nu & \left( \frac{ - x}{4 a b} + \frac{-1}{4 b} \right) \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \nu + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{x}{4 a b} + \frac{1}{4 b} \right) + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( \frac{y}{4 a b} + \frac{1}{4 a} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \nu + \frac{1}{2} \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right) \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right) \left( 1 - \nu \right) & \left( \frac{ - x}{4 a b} + \frac{1}{4 b} \right)^{2} + \frac{1}{2} \left( \frac{-1}{4 a} + \frac{ - y}{4 a b} \right)^{2} \left( 1 - \nu \right) \\
\end{array}
\right]
\end{equation}
</div>
<p>Substituting values in place of a (width) and b (height). We do so to reduce the number of symbolic variables and simplify expressions further.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">K_evaluated</span> <span class="o">=</span> <span class="n">substitute</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="kt">Dict</span><span class="p">(</span><span class="n">a</span> <span class="o">=&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">b</span> <span class="o">=&gt;</span> <span class="mf">0.5</span><span class="p">))</span>
</span></span></code></pre></div><div class="wide-matrix-container">
\begin{equation}
\left[
\begin{array}{cccccccc}
\left( -0.5 + y \right)^{2} + \frac{1}{2} \left( -0.5 + x \right)^{2} \left( 1 - \nu \right) & \left( -0.5 + x \right) \left( -0.5 + y \right) \nu + \frac{1}{2} \left( -0.5 + x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 + y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 + x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( -0.5 + x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) + \left( -0.5 - x \right) \left( -0.5 + y \right) \nu & \left( -0.5 + y \right) \left( 0.5 + y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 + x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( -0.5 + x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) + \left( 0.5 + x \right) \left( -0.5 + y \right) \nu & \left( -0.5 - y \right) \left( -0.5 + y \right) + \frac{1}{2} \left( -0.5 + x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( -0.5 + x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( -0.5 + y \right) \nu \\
\left( -0.5 + x \right) \left( -0.5 + y \right) \nu + \frac{1}{2} \left( -0.5 + x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 + x \right)^{2} + \frac{1}{2} \left( -0.5 + y \right)^{2} \left( 1 - \nu \right) & \left( -0.5 + x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( -0.5 + x \right) + \frac{1}{2} \left( -0.5 + y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 + x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( -0.5 + x \right) + \frac{1}{2} \left( -0.5 + y \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 - x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) + \left( -0.5 + x \right) \left( -0.5 - y \right) \nu & \left( -0.5 + x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( -0.5 + y \right) \left( 1 - \nu \right) \\
\left( -0.5 + y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 + x \right) \left( 1 - \nu \right) & \left( -0.5 + x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 - y \right)^{2} + \frac{1}{2} \left( -0.5 - x \right)^{2} \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( 0.5 + y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 - x \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 - y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( 0.5 - y \right) \nu \\
\frac{1}{2} \left( -0.5 + x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) + \left( -0.5 - x \right) \left( -0.5 + y \right) \nu & \left( -0.5 - x \right) \left( -0.5 + x \right) + \frac{1}{2} \left( -0.5 + y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 - x \right)^{2} + \frac{1}{2} \left( 0.5 - y \right)^{2} \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) + \left( -0.5 - x \right) \left( 0.5 + y \right) \nu & \left( 0.5 + x \right) \left( -0.5 - x \right) + \frac{1}{2} \left( 0.5 + y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( -0.5 - y \right) \nu + \frac{1}{2} \left( 0.5 - x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) \\
\left( -0.5 + y \right) \left( 0.5 + y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 + x \right) \left( 1 - \nu \right) & \left( -0.5 + x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 - x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) + \left( -0.5 - x \right) \left( 0.5 + y \right) \nu & \left( 0.5 + y \right)^{2} + \frac{1}{2} \left( 0.5 + x \right)^{2} \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 - y \right) \left( 0.5 + y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \left( 0.5 - x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) \\
\frac{1}{2} \left( -0.5 + x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) + \left( 0.5 + x \right) \left( -0.5 + y \right) \nu & \left( 0.5 + x \right) \left( -0.5 + x \right) + \frac{1}{2} \left( -0.5 + y \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 - y \right) \nu + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( -0.5 - x \right) + \frac{1}{2} \left( 0.5 + y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right)^{2} + \frac{1}{2} \left( 0.5 + y \right)^{2} \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( -0.5 - y \right) \nu + \frac{1}{2} \left( 0.5 - x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( 0.5 + y \right) \left( 1 - \nu \right) \\
\left( -0.5 - y \right) \left( -0.5 + y \right) + \frac{1}{2} \left( -0.5 + x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 - x \right) \left( -0.5 + y \right) \left( 1 - \nu \right) + \left( -0.5 + x \right) \left( -0.5 - y \right) \nu & \left( -0.5 - y \right) \left( 0.5 - y \right) + \frac{1}{2} \left( -0.5 - x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \left( -0.5 - x \right) \left( -0.5 - y \right) \nu + \frac{1}{2} \left( 0.5 - x \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( -0.5 - y \right) \left( 0.5 + y \right) + \frac{1}{2} \left( 0.5 + x \right) \left( 0.5 - x \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( -0.5 - y \right) \nu + \frac{1}{2} \left( 0.5 - x \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \left( -0.5 - y \right)^{2} + \frac{1}{2} \left( 0.5 - x \right)^{2} \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 - x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( -0.5 - y \right) \nu \\
\frac{1}{2} \left( -0.5 + x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( -0.5 + y \right) \nu & \left( -0.5 + x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( -0.5 + y \right) \left( 1 - \nu \right) & \frac{1}{2} \left( -0.5 - x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( 0.5 - y \right) \nu & \left( -0.5 - x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( 0.5 - y \right) \left( 1 - \nu \right) & \left( 0.5 - x \right) \left( 0.5 + y \right) \nu + \frac{1}{2} \left( 0.5 + x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) & \left( 0.5 + x \right) \left( 0.5 - x \right) + \frac{1}{2} \left( -0.5 - y \right) \left( 0.5 + y \right) \left( 1 - \nu \right) & \frac{1}{2} \left( 0.5 - x \right) \left( -0.5 - y \right) \left( 1 - \nu \right) + \left( 0.5 - x \right) \left( -0.5 - y \right) \nu & \left( 0.5 - x \right)^{2} + \frac{1}{2} \left( -0.5 - y \right)^{2} \left( 1 - \nu \right) \\
\end{array}
\right]
\end{equation}
</div>
<p>First, integrating with respect to x and applying limits.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">first_integration_wrt_x_elementwise</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">element</span> <span class="o">-&gt;</span> <span class="n">integrate</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">detailed</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="n">symbolic</span> <span class="o">=</span> <span class="nb">true</span><span class="p">),</span> <span class="n">K_evaluated</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>8×8 Matrix{SymbolicUtils.BasicSymbolic{Real}}:
 0.416667 - y - 0.166667ν + y^2      0.125 - 0.25y + 0.125ν - 0.25y*ν                            -0.166667 + y - 0.0833333ν - (y^2)  …  0.0833333 + 0.166667ν - (y^2)       0.125 + 0.25y - 0.375ν + 0.25y*ν
 0.125 - 0.25y + 0.125ν - 0.25y*ν    0.458333 - 0.5y - 0.125ν + 0.5(y^2) + 0.5y*ν - 0.5(y^2)*ν   0.125 - 0.25y - 0.375ν + 0.75y*ν       -0.125 + 0.25y + 0.375ν + 0.25y*ν   -0.208333 - 0.125ν - 0.5(y^2) + 0.5(y^2)*ν
 -0.166667 + y - 0.0833333ν - (y^2)  0.125 - 0.25y - 0.375ν + 0.75y*ν                            0.416667 - y - 0.166667ν + y^2         -0.333333 + 0.0833333ν + y^2        0.125 + 0.25y + 0.125ν - 0.75y*ν
 -0.125 + 0.25y + 0.375ν - 0.75y*ν   0.0416667 + 0.5y + 0.125ν - 0.5(y^2) - 0.5y*ν + 0.5(y^2)*ν  -0.125 + 0.25y - 0.125ν + 0.25y*ν      0.125 - 0.25y + 0.125ν + 0.75y*ν    -0.291667 + 0.125ν + 0.5(y^2) - 0.5(y^2)*ν
 -0.333333 + 0.0833333ν + y^2        -0.125 + 0.25y - 0.125ν - 0.75y*ν                           0.0833333 + 0.166667ν - (y^2)          -0.166667 - y - 0.0833333ν - (y^2)  -0.125 - 0.25y + 0.375ν + 0.75y*ν
 -0.125 - 0.25y - 0.125ν + 0.75y*ν   -0.291667 + 0.125ν + 0.5(y^2) - 0.5(y^2)*ν                  -0.125 - 0.25y + 0.375ν - 0.25y*ν   …  0.125 + 0.25y - 0.375ν - 0.75y*ν    0.0416667 - 0.5y + 0.125ν - 0.5(y^2) + 0.5y*ν + 0.5(y^2)*ν
 0.0833333 + 0.166667ν - (y^2)       -0.125 + 0.25y + 0.375ν + 0.25y*ν                           -0.333333 + 0.0833333ν + y^2           0.416667 + y - 0.166667ν + y^2      -0.125 - 0.25y - 0.125ν - 0.25y*ν
 0.125 + 0.25y - 0.375ν + 0.25y*ν    -0.208333 - 0.125ν - 0.5(y^2) + 0.5(y^2)*ν                  0.125 + 0.25y + 0.125ν - 0.75y*ν       -0.125 - 0.25y - 0.125ν - 0.25y*ν   0.458333 + 0.5y - 0.125ν + 0.5(y^2) - 0.5y*ν - 0.5(y^2)*ν
</code></pre>
<p>Some matrix elements are not shown in the above matrix. We then integrate with respect to y and apply limits.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-julia" data-lang="julia"><span class="line"><span class="cl"><span class="n">second_integration_wrt_y_elementwise</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">element</span> <span class="o">-&gt;</span> <span class="n">integrate</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">detailed</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="n">symbolic</span> <span class="o">=</span> <span class="nb">true</span><span class="p">),</span> <span class="n">first_integration_wrt_x_elementwise</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>8×8 Matrix{SymbolicUtils.BasicSymbolic{Real}}:
 0.5 - 0.166667ν     0.125 + 0.125ν           -0.25 - 0.0833333ν  -0.125 + 0.375ν          -0.25 + 0.0833333ν  -0.125 - 0.125ν          0.166667ν           0.125 - 0.375ν
 0.125 + 0.125ν      0.5 - 0.166667ν          0.125 - 0.375ν      6.93889e-18 + 0.166667ν  -0.125 - 0.125ν     -0.25 + 0.0833333ν       -0.125 + 0.375ν     -0.25 - 0.0833333ν
 -0.25 - 0.0833333ν  0.125 - 0.375ν           0.5 - 0.166667ν     -0.125 - 0.125ν          0.166667ν           -0.125 + 0.375ν          -0.25 + 0.0833333ν  0.125 + 0.125ν
 -0.125 + 0.375ν     6.93889e-18 + 0.166667ν  -0.125 - 0.125ν     0.5 - 0.166667ν          0.125 - 0.375ν      -0.25 - 0.0833333ν       0.125 + 0.125ν      -0.25 + 0.0833333ν
 -0.25 + 0.0833333ν  -0.125 - 0.125ν          0.166667ν           0.125 - 0.375ν           0.5 - 0.166667ν     0.125 + 0.125ν           -0.25 - 0.0833333ν  -0.125 + 0.375ν
 -0.125 - 0.125ν     -0.25 + 0.0833333ν       -0.125 + 0.375ν     -0.25 - 0.0833333ν       0.125 + 0.125ν      0.5 - 0.166667ν          0.125 - 0.375ν      6.93889e-18 + 0.166667ν
 0.166667ν           -0.125 + 0.375ν          -0.25 + 0.0833333ν  0.125 + 0.125ν           -0.25 - 0.0833333ν  0.125 - 0.375ν           0.5 - 0.166667ν     -0.125 - 0.125ν
 0.125 - 0.375ν      -0.25 - 0.0833333ν       0.125 + 0.125ν      -0.25 + 0.0833333ν       -0.125 + 0.375ν     6.93889e-18 + 0.166667ν  -0.125 - 0.125ν     0.5 - 0.166667ν
</code></pre>
<p>For a check of the results, we can compare our obtained stiffness matrix with the stiffness matrix reported in reference 3 (code line number 87 to 99 in paper).</p>
<h3 id="caveat">Caveat</h3>
<p>Though the symbolic approach works well for the rectangular element, it might not work for more complex elements. This is because the symbolic integrations are not always exact. Symbolic integrations in Julia usually produce the solution along with an unsolved portion and error. Fortunately, in our case we did not require the error term. It is also a good practice to substitute values (of symbols) wherever possible to simplify the expression rather than doing all the computations symbolically and then substituting the values at the end.</p>
<h3 id="references">References</h3>
<ol>
<li>Concepts and applications of finite element analysis by Robert D. Cook, et. al. (John Wiley &amp; Sons, Inc., Fourth Edition)</li>
<li>A first course in the finite element method by Daryl L. Logan (Cengage Learning, Fifth Edition)</li>
<li>A 99 line topology optimization code written in MATLAB (Springer, 2001) by <a href="https://www.dtu.dk/english/Person/cwis?id=2278&amp;cpid=927&amp;tab=1&amp;entity=profile" target="_blank" rel="noopener">Ole Sigmund</a> (Link: <a href="https://www.topopt.mek.dtu.dk/apps-and-software/a-99-line-topology-optimization-code-written-in-matlab" target="_blank" rel="noopener">https://www.topopt.mek.dtu.dk/apps-and-software/a-99-line-topology-optimization-code-written-in-matlab</a>, Last accessed: 25 Feb 2024)</li>
</ol>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/fea/">FEA</a>
  
  <a class="badge badge-light" href="/tag/julia/">Julia</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F&amp;text=Compute&#43;element&#43;stiffness&#43;matrix&#43;symbolically" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F&amp;t=Compute&#43;element&#43;stiffness&#43;matrix&#43;symbolically" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Compute%20element%20stiffness%20matrix%20symbolically&amp;body=http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F&amp;title=Compute&#43;element&#43;stiffness&#43;matrix&#43;symbolically" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Compute&#43;element&#43;stiffness&#43;matrix&#43;symbolically%20http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=http%3A%2F%2Flocalhost%3A1313%2Fpost%2Fcompute-element-stiffness-matrix-symbolically%2F&amp;title=Compute&#43;element&#43;stiffness&#43;matrix&#43;symbolically" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="http://localhost:1313/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu3e225c89d6328e00dc57563a3fd76514_183341_270x270_fill_q75_lanczos_center.jpg" alt="Biswajit Sahoo"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="http://localhost:1313/">Biswajit Sahoo</a></h5>
      <h6 class="card-subtitle">Machine Learning Engineer</h6>
      <p class="card-text">My research interests include machine learning, deep learning, signal processing and data-driven machinery condition monitoring.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/biswajitsahoo1111" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/biswajitsahoo1111/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.in/citations?hl=en&amp;user=zu2CSBMAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>













  
  




  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

    











  
    
    
    
    
    













  
  <p class="powered-by copyright-license-text">
    © 2024 Biswajit Sahoo. Powered by <a href="https://hugoblox.com/" target="_blank" rel="noopener">Hugo Blox Builder</a>.
  </p>
  




  
    <p class="powered-by">
      
    </p>
  </footer>
    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.js" type="module"></script>


















</body>
</html>
